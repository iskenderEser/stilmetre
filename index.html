<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sosyal Stil Belirleme Gözlem Formu</title>
  <meta name="description" content="Gözleme dayalı sosyal stil belirleme formu. İşaretlenen ifadeler sayılarak baskın stil kombinasyonu bulunur." />

  <style>
    :root{
      --bg:#ffffff;
      --text:#121212;
      --muted:#5f6368;
      --border:#e6e6e6;
      --soft:#f7f7f8;
      --shadow: 0 8px 24px rgba(0,0,0,.08);
      --radius: 16px;
      --gap: 14px;

      --red:#d32f2f;
      --blue:#1565c0;
      --green:#2e7d32;
      --yellow:#f9a825;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--text);
      background:linear-gradient(180deg, #fff 0%, #fafafa 100%);
      padding: 20px 14px 60px;
    }

    .wrap{ max-width: 1100px; margin:0 auto; }

    header{
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom: 16px;
    }

    h1{
      font-size: clamp(20px, 2.4vw, 28px);
      margin:0;
      letter-spacing:-.2px;
    }
    .sub{
      margin:6px 0 0;
      color:var(--muted);
      line-height:1.4;
      max-width: 72ch;
      font-size: 14px;
    }

    .topActions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    button{
      border:1px solid var(--border);
      background:#fff;
      color:var(--text);
      padding:10px 12px;
      border-radius: 12px;
      cursor:pointer;
      box-shadow: 0 1px 0 rgba(0,0,0,.02);
      font-weight: 600;
      font-size: 13px;
    }
    button:hover{ background:var(--soft); }
    button:active{ transform: translateY(1px); }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: var(--gap);
      margin-top: 14px;
    }
    @media(min-width: 960px){
      .grid{ grid-template-columns: 1.1fr .9fr; }
    }

    .card{
      background: var(--bg);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding: 14px 16px;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      background: #fff;
    }
    .cardTitle{
      margin:0;
      font-size: 15px;
      letter-spacing:-.1px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size: 12px;
      color: var(--muted);
      padding: 6px 10px;
      border:1px solid var(--border);
      border-radius: 999px;
      background: #fff;
      white-space: nowrap;
    }
    .cardBody{ padding: 12px 12px 14px; }

    .groups{
      display:grid;
      grid-template-columns: 1fr;
      gap: var(--gap);
    }
    @media(min-width: 760px){
      .groups{ grid-template-columns: 1fr 1fr; }
    }

    .group{
      border:1px solid var(--border);
      border-radius: 14px;
      overflow:hidden;
      background:#fff;
    }
    .groupHead{
      padding: 12px 12px;
      background: #fff;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .groupName{
      font-weight:800;
      font-size: 13px;
      margin:0;
    }
    .count{
      font-weight:800;
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: var(--soft);
      border: 1px solid var(--border);
      min-width: 54px;
      text-align:center;
    }

    .items{
      padding: 10px 10px 12px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    label.item{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding: 10px 10px;
      border-radius: 12px;
      border:1px solid var(--border);
      background:#fff;
      cursor:pointer;
    }
    label.item:hover{ background: var(--soft); }
    input[type="checkbox"]{
      margin-top: 2px;
      transform: scale(1.1);
      accent-color: #111;
    }
    .txt{
      font-size: 13px;
      line-height: 1.35;
    }

    .resultBox{
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .resultBig{
      padding: 14px 16px;
      border-radius: 16px;
      border:1px solid var(--border);
      background:#fff;
    }
    .resultTitle{
      margin:0;
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
      letter-spacing: .2px;
      text-transform: uppercase;
    }
    .resultValue{
      margin:6px 0 0;
      font-size: 20px;
      font-weight: 900;
      letter-spacing: -.2px;
    }
    .resultMeta{
      margin:6px 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height:1.4;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      border-radius: 999px;
      padding: 8px 12px;
      border:1px solid var(--border);
      background:#fff;
      font-weight: 800;
      font-size: 13px;
      width: fit-content;
    }
    .dot{
      width:10px; height:10px;
      border-radius: 50%;
      background:#999;
      flex: 0 0 auto;
    }

    .miniRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 10px;
    }

    .note{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.45;
      padding: 0 2px;
    }

    .footer{
      margin-top: 14px;
      color: var(--muted);
      font-size: 12px;
      line-height:1.45;
    }

    .warn{
      border-left: 4px solid #999;
      padding: 10px 12px;
      background: #fff;
      border:1px solid var(--border);
      border-radius: 12px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Sosyal Stil Belirleme Gözlem Formu</h1>
        <p class="sub">
          Bu araç test/anket değildir; <b>gözleme dayalı</b> bir formdur. Her grup altındaki uygun ifadeleri işaretleyin.
          İşaretlenen ifadeler sayılır; <b>en yüksek iki grup</b> sosyal stil kombinasyonunu verir.
          <br><b>Limit:</b> T+A en fazla 15, C+E en fazla 15.
        </p>
      </div>

      <div class="topActions">
        <button id="btnReset" type="button">Tümünü Temizle</button>
        <button id="btnCopy" type="button">Sonucu Kopyala</button>
      </div>
    </header>

    <div class="grid">

      <!-- LEFT: groups -->
      <section class="card">
        <div class="cardHead">
          <h2 class="cardTitle">Gözlem İfadeleri</h2>
          <div class="pill" id="totalChecked">İşaretli: 0</div>
        </div>

        <div class="cardBody">
          <div class="groups" id="groupsRoot"></div>
          <div class="footer">
            İpucu: Aynı kişiyi farklı bağlamlarda gözlediyseniz, sadece <b>gözlediğiniz</b> davranışlara göre işaretleyin.
          </div>
        </div>
      </section>

      <!-- RIGHT: results -->
      <aside class="card">
        <div class="cardHead">
          <h2 class="cardTitle">Sonuç</h2>
          <div class="pill" id="topTwoPill">Top 2: —</div>
        </div>

        <div class="cardBody resultBox">
          <div class="resultBig">
            <p class="resultTitle">Baskın Stil</p>
            <div class="miniRow">
              <span class="badge" id="styleBadge">
                <span class="dot" id="styleDot"></span>
                <span id="styleName">—</span>
              </span>
            </div>
            <p class="resultMeta" id="styleMeta">İşaretleme yaptıkça stil otomatik hesaplanır.</p>
          </div>

          <div class="resultBig">
            <p class="resultTitle">Grup Sayımları</p>
            <p class="resultMeta" id="countsText">T: 0 • A: 0 • C: 0 • E: 0</p>

            <!-- Limit uyarısı -->
            <div class="warn note" id="limitNote" style="display:none;"></div>

            <!-- Kenar durum notu -->
            <div class="warn note" id="edgeNote" style="display:none;"></div>
          </div>

          <div class="note">
            Eşleşme mantığı:<br/>
            <b>T+C</b> → Yönlendirici (Kırmızı) • <b>A+C</b> → Analitik (Mavi) • <b>A+E</b> → Canayakın (Yeşil) • <b>T+E</b> → İfadeci (Sarı)
          </div>
        </div>
      </aside>

    </div>
  </div>

  <script>
    // --- Data (s4 Gruplandırılmış_3rd) ---
    const DATA = [
      {
        key: "T",
        title: "Söyleyen İddiacı (T)",
        items: [
          "Olaylar karşısında düşüncelerini hemen ifade etmek ister.",
          "Kendisine verilen bir görevi bir an önce yapmak ister.",
          "Hayatta risk almak gerektiğini düşünür.",
          "Önce kendisi el uzatır.",
          "Bir karmaşa olduğunda kontrolü ele almak ister.",
          "İletişimlerde dışa dönük ve açık sözlüdür.",
          "Sonuçların kendisi için önemli olduğunu düşünür.",
          "Fikirlerini tartışarak ikna etmeyi tercih eder.",
          "Çok sabırlı olmadığı söylenir.",
          "Rekabeti sever.",
          "Grup içinde ön planda olmak ister.",
          "Çabuk karar verir.",
          "Grubun kendisini takip etmesini ister.",
          "Görüşlerini ve düşüncelerini hemen paylaşır.",
          "İşleri kendi yöntemleriyle yapmayı tercih eder."
        ]
      },
      {
        key: "A",
        title: "Soran İddiacı (A)",
        items: [
          "Her akla geleni söylemez.",
          "Kendisine verilen bir görevi yerine getirirken acele etmemek gerektiğini düşünür.",
          "Hayatta riskleri öngörmenin önemli olduğunu düşünür.",
          "Önce karşısındakinin elini uzatmasını bekler.",
          "Bir karmaşa olduğunda önce izlemeyi tercih eder.",
          "İletişimlerde dinlemeyi ve izlemeyi tercih eder.",
          "Süreçleri ve yöntemleri bilmek ister.",
          "Fikirlerini bir kere söyler ve dinler.",
          "Oldukça sabırlıdır.",
          "İş birliği yapmayı tercih eder.",
          "Grup içinde ön planda olmayı tercih etmez.",
          "Karar vermek için zamana ihtiyaç duyar.",
          "Gruba göre hareket etmeyi tercih eder.",
          "Görüşlerini ve düşüncelerini hemen ifade etmeyi tercih etmez.",
          "Yapılanları onaylamayı tercih eder."
        ]
      },
      {
        key: "C",
        title: "Düşük Tepkisel (C)",
        items: [
          "İlişkilerde mesafelidir.",
          "Duygularını ifade etmeyi pek tercih etmez.",
          "Olur olmadık yerde şaka yapılmasından hoşlanmaz.",
          "Gerçeklere dayanarak konuşur.",
          "Bir görev verildiğinde yalnız çalışmayı tercih eder.",
          "Kişilerin olaylar karşısında düşündüklerini anlamaya çalışır.",
          "İlişkilerinde resmiyeti tercih eder.",
          "İşlerin yürümesi için herkesin işini yapması gerektiğini düşünür.",
          "Çoğu zaman çevresinde olup bitenlerden en son haberdar olur.",
          "Daha çok görev odaklı biri olduğunu düşünür.",
          "Çevresinin kendisini sokulgan olarak tanımlamasından hoşlanmaz.",
          "İlişkilerinde duyguların ikinci planda olduğunu düşünür.",
          "Kişilere karşı isteklerini söylemekten çekinmez.",
          "İletişimlerinde temkinli ve ölçülüdür.",
          "Duyguların anlaşılması gerektiğini düşünür."
        ]
      },
      {
        key: "E",
        title: "Yüksek Tepkisel (E)",
        items: [
          "İlişkilerde sıcak ve arkadaşça yaklaştığını düşünür.",
          "Duyguları ifade etmenin iletişim için önemli olduğuna inanır.",
          "Arkadaşlarıyla şakalaşmayı sever.",
          "Görüşlerini öne sürerek konuşur.",
          "Bir görev verildiğinde ortak çalışmayı tercih eder.",
          "Kişilerin olaylar karşısında hissettiklerini anlamaya çalışır.",
          "Çevresindeki birçok kişiyle samimi olduğunu düşünür.",
          "İşlerini kişisel ilişkilerle halletmeyi tercih eder.",
          "Çevresinde olup bitenlerle ilgili çoğu kişiden önce haberdar olur.",
          "Daha çok ilişki odaklı biri olduğunu düşünür.",
          "Çevresindeki kişilere karşı yakın ve açıktır.",
          "İlişkilerinde önce duyguları anlamak ister.",
          "Kişilere karşı anlayışlıdır.",
          "İletişimlerinde zorlayıcıdır.",
          "Duyguların paylaşılması gerektiğine inanır."
        ]
      }
    ];

    // Quadrant mapping
    const STYLE_MAP = {
      "T+C": { name: "Yönlendirici", color: "var(--red)" },
      "A+C": { name: "Analitik",     color: "var(--blue)" },
      "A+E": { name: "Canayakın",    color: "var(--green)" },
      "T+E": { name: "İfadeci",      color: "var(--yellow)" }
    };

    // Helpers
    const qs = (s, el=document) => el.querySelector(s);
    const qsa = (s, el=document) => Array.from(el.querySelectorAll(s));

    const groupsRoot = qs("#groupsRoot");
    const totalCheckedEl = qs("#totalChecked");
    const countsText = qs("#countsText");
    const topTwoPill = qs("#topTwoPill");
    const styleNameEl = qs("#styleName");
    const styleDotEl = qs("#styleDot");
    const styleMetaEl = qs("#styleMeta");
    const edgeNoteEl = qs("#edgeNote");
    const limitNoteEl = qs("#limitNote");

    // --- LIMIT RULES ---
    const AXIS_CAP = 15; // T+A max 15, C+E max 15

    function showLimit(msg){
      limitNoteEl.style.display = "block";
      limitNoteEl.textContent = msg;
      clearTimeout(showLimit._t);
      showLimit._t = setTimeout(() => {
        limitNoteEl.style.display = "none";
        limitNoteEl.textContent = "";
      }, 1600);
    }

    function axisTotal(axisKey){
      // axisKey: "TA" or "CE"
      const groups = axisKey === "TA" ? ["T","A"] : ["C","E"];
      return qsa('input[type="checkbox"][data-group]')
        .filter(ch => ch.checked && groups.includes(ch.dataset.group))
        .length;
    }

    function buildUI(){
      groupsRoot.innerHTML = "";

      for (const g of DATA){
        const group = document.createElement("div");
        group.className = "group";
        group.dataset.group = g.key;

        group.innerHTML = `
          <div class="groupHead">
            <p class="groupName">${g.title}</p>
            <div class="count" id="count-${g.key}">0</div>
          </div>
          <div class="items" id="items-${g.key}"></div>
        `;

        const itemsEl = group.querySelector(`#items-${g.key}`);
        g.items.forEach((txt, idx) => {
          const id = `${g.key}-${idx}`;
          const label = document.createElement("label");
          label.className = "item";
          label.innerHTML = `
            <input type="checkbox" data-group="${g.key}" id="${id}" />
            <span class="txt">${txt}</span>
          `;
          itemsEl.appendChild(label);
        });

        groupsRoot.appendChild(group);
      }

      // IMPORTANT: enforce axis caps here
      groupsRoot.addEventListener("change", (e) => {
        const target = e.target;
        if (!(target instanceof HTMLInputElement) || target.type !== "checkbox") {
          recalc();
          return;
        }

        // Only enforce when checking ON (unchecking is always allowed)
        if (target.checked) {
          const g = target.dataset.group; // "T","A","C","E"
          const axis = (g === "T" || g === "A") ? "TA" : "CE";
          const total = axisTotal(axis);

          if (total > AXIS_CAP) {
            target.checked = false; // revert
            showLimit(axis === "TA"
              ? "Limit: Söyleyen İddiacı (T) + Soran İddiacı (A) toplamı en fazla 15 olabilir."
              : "Limit: Düşük Tepkisel (C) + Yüksek Tepkisel (E) toplamı en fazla 15 olabilir."
            );
          }
        }

        recalc();
      });

      recalc();
    }

    function getCounts(){
      const counts = { T:0, A:0, C:0, E:0 };
      const checks = qsa('input[type="checkbox"][data-group]');
      for (const ch of checks){
        if (ch.checked) counts[ch.dataset.group]++;
      }
      return { counts, total: checks.filter(c => c.checked).length };
    }

    function pickTopTwoAcrossAxes(counts){
      const entries = Object.entries(counts)
        .map(([k,v]) => ({k, v}))
        .sort((a,b) => b.v - a.v);

      if (entries[0].v === 0) return { top: [], note: "" };

      const first = entries[0];
      const second = entries[1];

      const assertive = new Set(["T","A"]);
      const reactive  = new Set(["C","E"]);

      const isSameAxis =
        (assertive.has(first.k) && assertive.has(second.k)) ||
        (reactive.has(first.k)  && reactive.has(second.k));

      if (!isSameAxis){
        return { top: [first.k, second.k], note: "" };
      }

      // Keep first; find best from other axis
      const needAxis = assertive.has(first.k) ? reactive : assertive;
      const fallback = entries.find(e => needAxis.has(e.k) && e.v > 0);

      if (fallback){
        return {
          top: [first.k, fallback.k],
          note: `Not: En yüksek iki grup aynı eksenden geldiği için (${first.k} + ${second.k}), stil hesaplaması diğer eksenden en yüksek olan grup ile tamamlandı (${fallback.k}).`
        };
      }

      return {
        top: [first.k],
        note: "Not: Stil belirlemek için iki eksenden de (T/A ve C/E) en az birer ifade işaretlenmelidir."
      };
    }

    function recalc(){
      const { counts, total } = getCounts();

      // Update counts UI
      ["T","A","C","E"].forEach(k => {
        const el = qs(`#count-${k}`);
        if (el) el.textContent = counts[k];
      });

      totalCheckedEl.textContent = `İşaretli: ${total}`;
      countsText.textContent = `T: ${counts.T} • A: ${counts.A} • C: ${counts.C} • E: ${counts.E}`;

      const { top, note } = pickTopTwoAcrossAxes(counts);
      edgeNoteEl.style.display = note ? "block" : "none";
      edgeNoteEl.textContent = note;

      if (top.length >= 2){
        const pair = `${top[0]}+${top[1]}`;
        const pair2 = `${top[1]}+${top[0]}`;
        const style = STYLE_MAP[pair] || STYLE_MAP[pair2];

        topTwoPill.textContent = `Top 2: ${top[0]} + ${top[1]}`;

        if (style){
          styleNameEl.textContent = `${style.name}`;
          styleDotEl.style.background = style.color;
          styleMetaEl.textContent = `Kombinasyon: ${top[0]} + ${top[1]}`;
        } else {
          styleNameEl.textContent = "—";
          styleDotEl.style.background = "#999";
          styleMetaEl.textContent = "Kombinasyon tanımlanamadı (harita kontrol edin).";
        }
      } else if (top.length === 1){
        topTwoPill.textContent = `Top 2: ${top[0]} + —`;
        styleNameEl.textContent = "—";
        styleDotEl.style.background = "#999";
        styleMetaEl.textContent = "Stil için diğer eksenden de işaretleme gerekir.";
      } else {
        topTwoPill.textContent = "Top 2: —";
        styleNameEl.textContent = "—";
        styleDotEl.style.background = "#999";
        styleMetaEl.textContent = "İşaretleme yaptıkça stil otomatik hesaplanır.";
      }
    }

    // Actions
    qs("#btnReset").addEventListener("click", () => {
      qsa('input[type="checkbox"][data-group]').forEach(c => c.checked = false);
      recalc();
    });

    qs("#btnCopy").addEventListener("click", async () => {
      const { counts } = getCounts();
      const { top } = pickTopTwoAcrossAxes(counts);

      let styleLine = "Stil: —";
      if (top.length >= 2){
        const pair = `${top[0]}+${top[1]}`;
        const pair2 = `${top[1]}+${top[0]}`;
        const style = STYLE_MAP[pair] || STYLE_MAP[pair2];
        if (style) styleLine = `Stil: ${style.name} (${top[0]} + ${top[1]})`;
      }

      const text =
`Sosyal Stil Belirleme Gözlem Formu
Sayım: T=${counts.T}, A=${counts.A}, C=${counts.C}, E=${counts.E}
${styleLine}`;

      try{
        await navigator.clipboard.writeText(text);
        const old = qs("#btnCopy").textContent;
        qs("#btnCopy").textContent = "Kopyalandı ✓";
        setTimeout(()=> qs("#btnCopy").textContent = old, 900);
      }catch(e){
        alert("Kopyalama başarısız. Tarayıcı izinlerini kontrol edin.");
      }
    });

    buildUI();
  </script>
</body>
</html>
